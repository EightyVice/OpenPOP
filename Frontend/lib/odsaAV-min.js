"use strict";(function(g){var d={},l={};if(typeof ODSA==="undefined"){d.AV_NAME="";d.MODULE_ORIGIN=location.protocol+"//"+location.host;if(!(window.console&&console.log)){console={log:function(){},debug:function(){},info:function(){},warn:function(){},error:function(){}}}l.serverEnabled=function(){return false};l.getNameFromURL=function(){return""};l.roundPercent=function(o){return Math.round(o*100)/100};l.sendEventData=function(){};l.logUserAction=function(p,r,o,q){};l.logEvent=function(o){};window.ODSA={};window.ODSA.SETTINGS=d;window.ODSA.UTILS=l;console.warn("ODSA.js was not included, using fallback function definitions")}else{d=ODSA.SETTINGS;l=ODSA.UTILS}var e=0;var a=0;var j="";var m=true;var f=+new Date();function k(o){f=+new Date();a=0;var p={av:d.AV_NAME,type:"odsa-exercise-init",desc:JSON.stringify(o)};g("body").trigger("jsav-log-event",[p])}function n(){var o={av:d.AV_NAME,type:"odsa-award-credit"};g("body").trigger("jsav-log-event",[o])}function c(r,o,s){s=(s)?s:Math.round((o+r)/2);var q="";for(var p=r;p<=o;p++){q+="<option ";if(p===s){q+='selected="selected" '}q+='value="'+p+'">'+p+"</option>"}g("#arraysize").html(q);g("#arraysize").data("min",r);g("#arraysize").data("max",o)}function i(o){g(".avcontainer").unbind().html(j);if(o!==true&&!g("#arrayValues").prop("disabled")){g("#arrayValues").val("")}}function h(q){q=(q)?q:999;var p,o={},s=g("#arraysize").data("min"),u=g("#arraysize").data("max"),t="Please enter "+s+" to "+u+" positive integers between 0 and "+q;if(!s||!u){console.warn("processArrayValues() called without calling initArraySize()")}var r=g("#arrayValues").val().match(/[0-9]+/g)||[];if(r.length===0){for(p=0;p<g("#arraysize").val();p++){r[p]=Math.floor(Math.random()*(q+1))}o.gen_array=r}else{if(r.length<s||r.length>u){alert(t);return null}for(p=0;p<r.length;p++){r[p]=Number(r[p]);if(isNaN(r[p])||r[p]<0||r[p]>q){alert(t);return null}}o.user_array=r;g("#arraysize").val(r.length)}g("input[type=text]").each(function(v,w){var x=g(w).attr("id");if(x!=="arrayValues"){o["user_"+x]=g(w).val()}});g("select").each(function(v,w){var x=g(w).attr("id");o["user_"+x]=g(w).val()});k(o);return r}var b={};b.logExerciseInit=k;b.awardCompletionCredit=n;b.initArraySize=c;b.reset=i;b.processArrayValues=h;window.ODSA.AV=b;JSAV._types.ds.AVArray.prototype.slice=function(r,o){var q=[];for(var p=0;p<(o-r);p++){q[p]=this.value(r+p)}return q};JSAV._types.ds.AVArray.prototype.highlightBlue=function(o){this.css(o,{"background-color":"#ddf"})};JSAV._types.ds.AVArray.prototype.markSorted=function(o){this.css(o,{"background-color":"#ffffcc"})};JSAV._types.ds.AVArray.prototype.toString=function(){var p=this.size();var q="[";for(var o=0;o<p;o++){q+=this.value(o);if(o<p-1){q+=", "}}q+="]";return q};g(document).ready(function(){d.AV_NAME=l.getNameFromURL();j=g(".avcontainer").html();g("body").on("jsav-log-event",function(t,r){var o=false,q=["jsav-init","jsav-recorded","jsav-exercise-model-init","jsav-exercise-model-recorded"],s=["jsav-forward","jsav-backward","jsav-begin","jsav-end","jsav-exercise-model-forward","jsav-exercise-model-backward","jsav-exercise-model-begin","jsav-exercise-model-end"];if(q.indexOf(r.type)>-1){return}r.av=d.AV_NAME;r.uiid=f;if(!r.desc||r.desc===""){r.desc=r.type}if(s.indexOf(r.type)>-1){r.desc=r.currentStep+" / "+r.totalSteps;if(r.currentStep===r.totalSteps){o=true}}else{if(r.type==="jsav-array-click"){r.desc=JSON.stringify({index:r.index,arrayid:r.arrayid})}else{if(r.type==="jsav-exercise-grade-change"){var u=l.roundPercent((r.score.student-r.score.fix)/r.score.total);var p=l.roundPercent(r.score.student/r.score.total);r.desc=JSON.stringify({score:u,complete:p});o=true}else{if(r.type==="jsav-exercise-model-open"){if(m&&g("span.jsavamidone").html()!=="DONE"){m=false;alert("You can no longer receive credit for the current instance of this exercise.\nClick 'Reset' or refresh the page to get a new problem instance.");g("span.jsavscore").hide();g("span.jsavscore").parent().append('<span id="credit_disabled_msg">Credit not given for this instance</span>')}}else{if(r.type==="jsav-exercise-reset"){o=true;if(!m){m=true;g("span.jsavscore").show();g("#credit_disabled_msg").remove()}}}}}}r.totalTime=a+(+new Date())-e;r.logged=true;parent.postMessage(r,d.MODULE_ORIGIN);if(l.serverEnabled()){l.logEvent(r);if(o){l.sendEventData()}}});if(l.serverEnabled()){l.logUserAction("document-ready","User loaded the "+d.AV_NAME+" AV");l.sendEventData();g(window).focus(function(o){l.logUserAction("window-focus","User looking at "+d.AV_NAME+" window");e=+new Date()});g(window).blur(function(o){l.logUserAction("window-blur","User is no longer looking at "+d.AV_NAME+" window");a+=(+new Date()-e)});g(window).on("beforeunload",function(){l.logUserAction("window-unload","User closed or refreshed "+d.AV_NAME+" window")})}})}(jQuery));